/*******************************************************************************
 * Compute temperature and yield strength envelopes for the oceanic lithosphere*
 *******************************************************************************/

#include "litho.h"

void set_litho_defaults(struct LITHO *);
void print_litho_defaults(struct LITHO *);
double temp_plt(struct LITHO *, double, double);

int main (int argc, char **argv)
{
	int verbose = 0;
        int i,nz=100;
        double dz;
        double age,curv,z,temp;

        struct LITHO *l;		/* pointer to litho structure*/

/* get the information from the command line */
        if(argc < 3){
                printf("\nUsage: test_litho age curvature \n \n");
                exit(-1);
        }

        age = atof(argv[1]);
        curv = atof(argv[2]);

	l = malloc(sizeof(struct LITHO));

        set_litho_defaults(l);
        if(verbose == 1) print_litho_defaults(l);

/*  compute a profile of temp */

        dz=l->dp/(nz-1);

        for(i=0;i<nz;i++){
        z=i*dz;
        temp=temp_plt(l,z,age);
        fprintf(stderr," z = %lf km depth, temp = %lf deg C\n",z*1.e-3,temp);
        fprintf(stdout,"%lf %lf \n",z*1.e-3,temp);
        }

	return(EXIT_SUCCESS);
}
